%% Full symbolic inertial matrix.
M = [(9*q1_dd*(4*cos(2*q2 + q3) + 12*cos(2*q2) + cos(2*q2 + 2*q3) + 4*cos(q3) + 13))/3200, 
    (9*q1_dd*(q2_dd - 1)*(4*cos(2*q2 + q3) + 12*cos(2*q2) + cos(2*q2 + 2*q3) + 4*cos(q3) + 13))/(3200*q2_dd),                                                                                                                                                                                                                                                                                                                            
    (9*q1_dd*(q3_dd - 1)*(4*cos(2*q2 + q3) + 12*cos(2*q2) + cos(2*q2 + 2*q3) + 4*cos(q3) + 13))/(3200*q3_dd);
    (((9*q1_dd)/2 - 9/2)*(130*q2_dd + 10*q3_dd + 654*cos(q2 + q3) + 3924*cos(q2) + 20*q1_d^2*sin(2*q2 + q3) + 60*q1_d^2*sin(2*q2) + 5*q1_d^2*sin(2*q2 + 2*q3) + 40*q2_dd*cos(q3) + 20*q3_dd*cos(q3)))/(8000*q1_dd),
    (180*q2_dd^2*cos(q3) - 2943*cos(q2 + q3) - 17658*cos(q2) - 45*q3_dd + 45*q2_dd*q3_dd - 90*q1_d^2*sin(2*q2 + q3) - 270*q1_d^2*sin(2*q2) + 2943*q2_dd*cos(q2 + q3) - (45*q1_d^2*sin(2*q2 + 2*q3))/2 + 17658*q2_dd*cos(q2) - 90*q3_dd*cos(q3) + 585*q2_dd^2 + (45*q1_d^2*q2_dd*sin(2*q2 + 2*q3))/2 + 90*q2_dd*q3_dd*cos(q3) + 90*q1_d^2*q2_dd*sin(2*q2 + q3) + 270*q1_d^2*q2_dd*sin(2*q2))/(8000*q2_dd),                              
    (90*q3_dd^2*cos(q3) - 2943*cos(q2 + q3) - 17658*cos(q2) - 585*q2_dd + 585*q2_dd*q3_dd - 90*q1_d^2*sin(2*q2 + q3) - 270*q1_d^2*sin(2*q2) + 2943*q3_dd*cos(q2 + q3) - (45*q1_d^2*sin(2*q2 + 2*q3))/2 - 180*q2_dd*cos(q3) + 17658*q3_dd*cos(q2) + 45*q3_dd^2 + (45*q1_d^2*q3_dd*sin(2*q2 + 2*q3))/2 + 180*q2_dd*q3_dd*cos(q3) + 90*q1_d^2*q3_dd*sin(2*q2 + q3) + 270*q1_d^2*q3_dd*sin(2*q2))/(8000*q3_dd);
    (((9*q1_dd)/2 - 9/2)*(10*q2_dd + 10*q3_dd + 654*cos(q2 + q3) + 10*q1_d^2*sin(q3) + 20*q2_d^2*sin(q3) + 10*q1_d^2*sin(2*q2 + q3) + 5*q1_d^2*sin(2*q2 + 2*q3) + 20*q2_dd*cos(q3) + 20*q2_d*q3_d*sin(q3)))/(8000*q1_dd), 
    (90*q3_dd^2*cos(q3) - 2943*cos(q2 + q3) - 17658*cos(q2) - 585*q2_dd + 585*q2_dd*q3_dd - 90*q1_d^2*sin(2*q2 + q3) - 270*q1_d^2*sin(2*q2) + 2943*q3_dd*cos(q2 + q3) - (45*q1_d^2*sin(2*q2 + 2*q3))/2 - 180*q2_dd*cos(q3) + 17658*q3_dd*cos(q2) + 45*q3_dd^2 + (45*q1_d^2*q3_dd*sin(2*q2 + 2*q3))/2 + 180*q2_dd*q3_dd*cos(q3) + 90*q1_d^2*q3_dd*sin(2*q2 + q3) + 270*q1_d^2*q3_dd*sin(2*q2))/(8000*q3_dd), 
    (45*q2_dd*q3_dd - 2943*cos(q2 + q3) - 45*q1_d^2*sin(q3) - 90*q2_d^2*sin(q3) - 45*q2_dd - 45*q1_d^2*sin(2*q2 + q3) + 2943*q3_dd*cos(q2 + q3) - (45*q1_d^2*sin(2*q2 + 2*q3))/2 - 90*q2_dd*cos(q3) + 45*q3_dd^2 + (45*q1_d^2*q3_dd*sin(2*q2 + 2*q3))/2 + 90*q2_dd*q3_dd*cos(q3) - 90*q2_d*q3_d*sin(q3) + 45*q1_d^2*q3_dd*sin(q3) + 90*q2_d^2*q3_dd*sin(q3) + 45*q1_d^2*q3_dd*sin(2*q2 + q3) + 90*q2_d*q3_d*q3_dd*sin(q3))/(8000*q3_dd)];

%% Full symbolic Coriolis matrix.
C = [-(9*q1_dd*(q1_dd + q2_dd + q3_dd - 3)*(4*cos(2*q2 + q3) + 12*cos(2*q2) + cos(2*q2 + 2*q3) + 4*cos(q3) + 13))/3200;
    (351*q2_dd)/1600 + (27*q3_dd)/1600 + (2943*cos(q2 + q3))/1600 + (8829*cos(q2))/800 - (9*q2_dd^2*cos(q3))/400 - (9*q3_dd^2*cos(q3))/800 - (117*q1_dd*q2_dd)/1600 - (9*q1_dd*q3_dd)/1600 - (63*q2_dd*q3_dd)/800 + (9*q1_d^2*sin(2*q2 + q3))/200 + (27*q1_d^2*sin(2*q2))/200 - (2943*q1_dd*cos(q2 + q3))/8000 - (2943*q2_dd*cos(q2 + q3))/8000 - (2943*q3_dd*cos(q2 + q3))/8000 + (9*q1_d^2*sin(2*q2 + 2*q3))/800 - (8829*q1_dd*cos(q2))/4000 - (8829*q2_dd*cos(q2))/4000 + (27*q2_dd*cos(q3))/400 - (8829*q3_dd*cos(q2))/4000 + (27*q3_dd*cos(q3))/800 - (117*q2_dd^2)/1600 - (9*q3_dd^2)/1600 - (9*q1_d^2*q1_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_d^2*q2_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_d^2*q3_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_dd*q2_dd*cos(q3))/400 - (9*q1_dd*q3_dd*cos(q3))/800 - (27*q2_dd*q3_dd*cos(q3))/800 - (9*q1_d^2*q1_dd*sin(2*q2 + q3))/800 - (9*q1_d^2*q2_dd*sin(2*q2 + q3))/800 - (9*q1_d^2*q3_dd*sin(2*q2 + q3))/800 - (27*q1_d^2*q1_dd*sin(2*q2))/800 - (27*q1_d^2*q2_dd*sin(2*q2))/800 - (27*q1_d^2*q3_dd*sin(2*q2))/800;
    (27*q2_dd)/1600 + (9*q3_dd)/800 + (2943*cos(q2 + q3))/2000 + (117*q2_dd^2)/(1600*q3_dd) - (9*q2_dd^2*cos(q3))/400 + (27*q1_d^2*sin(q3))/1600 + (27*q2_d^2*sin(q3))/800 - (9*q1_dd*q2_dd)/1600 - (9*q1_dd*q3_dd)/1600 - (9*q2_dd*q3_dd)/800 + (27*q1_d^2*sin(2*q2 + q3))/1600 - (2943*q1_dd*cos(q2 + q3))/8000 - (2943*q2_dd*cos(q2 + q3))/8000 - (2943*q3_dd*cos(q2 + q3))/8000 + (27*q1_d^2*sin(2*q2 + 2*q3))/3200 - (8829*q2_dd*cos(q2))/4000 + (27*q2_dd*cos(q3))/800 - (117*q2_dd^2)/1600 - (9*q3_dd^2)/1600 - (9*q1_d^2*q1_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_d^2*q2_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_d^2*q3_dd*sin(2*q2 + 2*q3))/3200 - (9*q1_dd*q2_dd*cos(q3))/800 - (9*q2_dd*q3_dd*cos(q3))/400 + (27*q2_d*q3_d*sin(q3))/800 + (2943*q2_dd*cos(q2 + q3))/(8000*q3_dd) + (8829*q2_dd*cos(q2))/(4000*q3_dd) - (9*q1_d^2*q1_dd*sin(q3))/1600 - (9*q2_d^2*q1_dd*sin(q3))/800 - (9*q1_d^2*q3_dd*sin(q3))/1600 - (9*q2_d^2*q3_dd*sin(q3))/800 - (9*q1_d^2*q1_dd*sin(2*q2 + q3))/1600 - (9*q1_d^2*q2_dd*sin(2*q2 + q3))/800 - (9*q1_d^2*q3_dd*sin(2*q2 + q3))/1600 + (9*q2_dd^2*cos(q3))/(400*q3_dd) - (27*q1_d^2*q2_dd*sin(2*q2))/800 + (9*q1_d^2*q2_dd*sin(2*q2 + q3))/(800*q3_dd) - (9*q2_d*q3_d*q1_dd*sin(q3))/800 - (9*q2_d*q3_d*q3_dd*sin(q3))/800 + (27*q1_d^2*q2_dd*sin(2*q2))/(800*q3_dd) + (9*q1_d^2*q2_dd*sin(2*q2 + 2*q3))/(3200*q3_dd)];

%% Full symbolic gravity vector.
G = [0, (2943*cos(q2 + q3))/8000 + (8829*cos(q2))/4000, (2943*cos(q2 + q3))/8000]';
                                             

                      